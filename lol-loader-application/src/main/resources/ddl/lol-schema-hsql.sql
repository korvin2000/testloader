-- Batch meta tables
CREATE TABLE BATCH_JOB_INSTANCE  (
   JOB_INSTANCE_ID BIGINT IDENTITY NOT NULL PRIMARY KEY ,
   VERSION BIGINT ,
   JOB_NAME VARCHAR(100) NOT NULL,
   JOB_KEY VARCHAR(32) NOT NULL,
   constraint JOB_INST_UN unique (JOB_NAME, JOB_KEY)
) ;

CREATE TABLE BATCH_JOB_EXECUTION  (
   JOB_EXECUTION_ID BIGINT IDENTITY NOT NULL PRIMARY KEY ,
   VERSION BIGINT  ,
   JOB_INSTANCE_ID BIGINT NOT NULL,
   CREATE_TIME TIMESTAMP NOT NULL,
   START_TIME TIMESTAMP DEFAULT NULL ,
   END_TIME TIMESTAMP DEFAULT NULL ,
   STATUS VARCHAR(10) ,
   EXIT_CODE VARCHAR(2500) ,
   EXIT_MESSAGE VARCHAR(2500) ,
   LAST_UPDATED TIMESTAMP,
   JOB_CONFIGURATION_LOCATION VARCHAR(2500) NULL,
   constraint JOB_INST_EXEC_FK foreign key (JOB_INSTANCE_ID)
   references BATCH_JOB_INSTANCE(JOB_INSTANCE_ID)
) ;

CREATE TABLE BATCH_JOB_EXECUTION_PARAMS  (
   JOB_EXECUTION_ID BIGINT NOT NULL ,
   TYPE_CD VARCHAR(6) NOT NULL ,
   KEY_NAME VARCHAR(100) NOT NULL ,
   STRING_VAL VARCHAR(250) ,
   DATE_VAL TIMESTAMP DEFAULT NULL ,
   LONG_VAL BIGINT ,
   DOUBLE_VAL DOUBLE PRECISION ,
   IDENTIFYING CHAR(1) NOT NULL ,
   constraint JOB_EXEC_PARAMS_FK foreign key (JOB_EXECUTION_ID)
   references BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
) ;

CREATE TABLE BATCH_STEP_EXECUTION  (
   STEP_EXECUTION_ID BIGINT IDENTITY NOT NULL PRIMARY KEY ,
   VERSION BIGINT NOT NULL,
   STEP_NAME VARCHAR(100) NOT NULL,
   JOB_EXECUTION_ID BIGINT NOT NULL,
   START_TIME TIMESTAMP NOT NULL ,
   END_TIME TIMESTAMP DEFAULT NULL ,
   STATUS VARCHAR(10) ,
   COMMIT_COUNT BIGINT ,
   READ_COUNT BIGINT ,
   FILTER_COUNT BIGINT ,
   WRITE_COUNT BIGINT ,
   READ_SKIP_COUNT BIGINT ,
   WRITE_SKIP_COUNT BIGINT ,
   PROCESS_SKIP_COUNT BIGINT ,
   ROLLBACK_COUNT BIGINT ,
   EXIT_CODE VARCHAR(2500) ,
   EXIT_MESSAGE VARCHAR(2500) ,
   LAST_UPDATED TIMESTAMP,
   constraint JOB_EXEC_STEP_FK foreign key (JOB_EXECUTION_ID)
   references BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
) ;

CREATE TABLE BATCH_STEP_EXECUTION_CONTEXT  (
   STEP_EXECUTION_ID BIGINT NOT NULL PRIMARY KEY,
   SHORT_CONTEXT VARCHAR(2500) NOT NULL,
   SERIALIZED_CONTEXT LONGVARCHAR ,
   constraint STEP_EXEC_CTX_FK foreign key (STEP_EXECUTION_ID)
   references BATCH_STEP_EXECUTION(STEP_EXECUTION_ID)
) ;

CREATE TABLE BATCH_JOB_EXECUTION_CONTEXT  (
   JOB_EXECUTION_ID BIGINT NOT NULL PRIMARY KEY,
   SHORT_CONTEXT VARCHAR(2500) NOT NULL,
   SERIALIZED_CONTEXT LONGVARCHAR ,
   constraint JOB_EXEC_CTX_FK foreign key (JOB_EXECUTION_ID)
   references BATCH_JOB_EXECUTION(JOB_EXECUTION_ID)
) ;

CREATE TABLE BATCH_STEP_EXECUTION_SEQ (
   ID BIGINT IDENTITY
);
CREATE TABLE BATCH_JOB_EXECUTION_SEQ (
   ID BIGINT IDENTITY
);
CREATE TABLE BATCH_JOB_SEQ (
   ID BIGINT IDENTITY
);


--- LOL TABLES
CREATE TABLE TBLLOL2DATA (
   cs_id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
   mappingid BIGINT NOT NULL,
   stichtag TIMESTAMP NOT NULL,
   importdatum TIMESTAMP NOT NULL,
   mitgliedsnummer VARCHAR(1024) NOT NULL,
   mandant VARCHAR(512),
   buchungskreis VARCHAR(512),
   bobiknummer VARCHAR(1024) NOT NULL,
   debitornummer VARCHAR(1024),
   name_1 VARCHAR(2048),
   name_2 VARCHAR(2048),
   name_3 VARCHAR(2048),
   name_4 VARCHAR(2048),
   plz VARCHAR(256),
   ort VARCHAR(256),
   land VARCHAR(256),
   inso VARCHAR(256),
   lolIndex BIGINT,
   branchenBezeichnung VARCHAR(1024),
   branchenCode VARCHAR(256),
   branchenArt VARCHAR(256),
   branchenLand VARCHAR(256),
   anzahlBelLiefer_2 BIGINT,
   anzahlBelPoolOhneLiefer_2 BIGINT,
   anzahlBelLiefer_4 BIGINT,
   anzahlBelPoolOhneLiefer_4 BIGINT,
   anzahlBelLiefer_8 BIGINT,
   anzahlBelPoolOhneLiefer_8 BIGINT,
   anzahlBelLiefer_12 BIGINT,
   anzahlBelPoolOhneLiefer_12 BIGINT,
   anzahlBelBranche BIGINT,
   anzahlCrefosBranche BIGINT,
   betragLiefer_2 BIGINT,
   betragLiefer_2_w VARCHAR(128),
   betragPoolOhneLiefer_2 BIGINT,
   betragPoolOhneLiefer_2_w VARCHAR(128),
   betragLiefer_4 BIGINT,
   betragLiefer_4_w VARCHAR(128),
   betragPoolOhneLiefer_4 BIGINT,
   betragPoolOhneLiefer_4_w VARCHAR(128),
   betragLiefer_8 BIGINT,
   betragLiefer_8_w VARCHAR(128),
   betragPoolOhneLiefer_8 BIGINT,
   betragPoolOhneLiefer_8_w VARCHAR(128),
   betragLiefer_12 BIGINT,
   betragLiefer_12_w VARCHAR(128),
   betragPoolOhneLiefer_12 BIGINT,
   betragPoolOhneLiefer_12_w VARCHAR(128),
   betragsvolumenOP BIGINT,
   betragsvolumenOP_w VARCHAR(128),
   betragBranche BIGINT,
   betragBranche_w VARCHAR(128),
   tageSollLiefer_2 BIGINT,
   tageSollPoolOhneLiefer_2 BIGINT,
   tageIstLiefer_2 BIGINT,
   tageIstPoolOhneLiefer_2 BIGINT,
   tageDiffLiefer_2 BIGINT,
   tageDiffPoolOhneLiefer_2 BIGINT,
   tageSollLiefer_4 BIGINT,
   tageSollPoolOhneLiefer_4 BIGINT,
   tageIstLiefer_4 BIGINT,
   tageIstPoolOhneLiefer_4 BIGINT,
   tageDiffLiefer_4 BIGINT,
   tageDiffPoolOhneLiefer_4 BIGINT,
   tageSollLiefer_8 BIGINT,
   tageSollPoolOhneLiefer_8 BIGINT,
   tageIstLiefer_8 BIGINT,
   tageIstPoolOhneLiefer_8 BIGINT,
   tageDiffLiefer_8 BIGINT,
   tageDiffPoolOhneLiefer_8 BIGINT,
   tageSollLiefer_12 BIGINT,
   tageSollPoolOhneLiefer_12 BIGINT,
   tageIstLiefer_12 BIGINT,
   tageIstPoolOhneLiefer_12 BIGINT,
   tageDiffLiefer_12 BIGINT,
   tageDiffPoolOhneLiefer_12 BIGINT,
   tageSollBranche BIGINT,
   tageIstBranche BIGINT,
   tageDiffBranche BIGINT,
   filename VARCHAR(1024) NOT NULL,
   businesscontact INTEGER DEFAULT 0 NOT NULL
);
